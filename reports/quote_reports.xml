<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <!-- ========================= -->
  <!-- Actions de rapport (PDF)  -->
  <!-- ========================= -->
  <report
      id="action_report_quote_prices"
      model="sale.order"
      string="Quotation (with prices)"
      report_type="qweb-pdf"
      name="portal_customer_quotes.report_quote_prices"
      file="portal_customer_quotes.report_quote_prices"
      print_report_name="'%s - Quotation.pdf' % (object.name or 'Quotation')"
      />

  <report
      id="action_report_quote_noprices"
      model="sale.order"
      string="Quotation (no prices)"
      report_type="qweb-pdf"
      name="portal_customer_quotes.report_quote_noprices"
      file="portal_customer_quotes.report_quote_noprices"
      print_report_name="'%s - Quotation (no prices).pdf' % (object.name or 'Quotation')"
      />

  <!-- ========================= -->
  <!-- Gabarit : AVEC PRIX       -->
  <!-- ========================= -->
  <template id="report_quote_prices">
    <t t-call="web.html_container">
      <t t-foreach="docs" t-as="o">
        <t t-call="web.external_layout">
          <div class="page">
            <h2 class="mt0">
              <span t-esc="o.company_id.name"/> — <t t-esc="o.name"/>
            </h2>
            <p class="mb8 text-muted">
              <t t-esc="o.company_id.partner_id.contact_address"/>
              <br/><t t-esc="o.company_id.phone"/> • <t t-esc="o.company_id.email"/>
            </p>

            <div class="row mb16">
              <div class="col-6">
                <strong t-translation="on">Customer</strong><br/>
                <t t-esc="o.partner_id.name"/><br/>
                <t t-esc="o.partner_id.contact_address"/>
              </div>
              <div class="col-6">
                <table class="table table-sm o_main_table" style="width:100%">
                  <tbody>
                    <tr>
                      <td><strong t-translation="on">Date</strong></td>
                      <td class="text-end"><t t-esc="o.date_order and o.date_order.date()"/></td>
                    </tr>
                    <tr>
                      <td><strong t-translation="on">Customer Reference</strong></td>
                      <td class="text-end"><t t-esc="o.x_customer_reference or '-'"/></td>
                    </tr>
                    <tr>
                      <td><strong t-translation="on">Expected Delivery</strong></td>
                      <td class="text-end"><t t-esc="o.x_expected_date or '-'"/></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <t t-if="o.x_project_description">
              <p class="mb16">
                <strong t-translation="on">Project Description:</strong><br/>
                <span t-esc="o.x_project_description"/>
              </p>
            </t>

            <table class="table table-sm o_main_table" style="width:100%">
              <thead>
                <tr>
                  <th t-translation="on">Product</th>
                  <th t-translation="on">Description</th>
                  <th class="text-end" t-translation="on">Qty</th>
                  <th class="text-end" t-translation="on">Unit Price</th>
                  <th class="text-end" t-translation="on">Subtotal</th>
                </tr>
              </thead>
              <tbody>
                <t t-foreach="o.order_line" t-as="l">
                  <tr>
                    <td><t t-esc="l.product_id.display_name"/></td>
                    <td><t t-esc="l.name"/></td>
                    <td class="text-end"><t t-esc="l.product_uom_qty"/></td>
                    <td class="text-end">
                      <span t-field="l.price_unit" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}"/>
                    </td>
                    <td class="text-end">
                      <span t-field="l.price_subtotal" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}"/>
                    </td>
                  </tr>
                </t>
              </tbody>
              <tfoot>
                <tr>
                  <td colspan="4" class="text-end"><strong t-translation="on">Untaxed Amount</strong></td>
                  <td class="text-end">
                    <span t-field="o.amount_untaxed" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}"/>
                  </td>
                </tr>
                <tr>
                  <td colspan="4" class="text-end"><strong t-translation="on">Taxes</strong></td>
                  <td class="text-end">
                    <span t-field="o.amount_tax" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}"/>
                  </td>
                </tr>
                <tr>
                  <td colspan="4" class="text-end"><strong t-translation="on">Total</strong></td>
                  <td class="text-end">
                    <span t-field="o.amount_total" t-options="{'widget': 'monetary', 'display_currency': o.currency_id}"/>
                  </td>
                </tr>
              </tfoot>
            </table>

            <t t-if="o.x_note">
              <div class="mt16">
                <strong t-translation="on">Notes</strong>
                <div><t t-esc="o.x_note"/></div>
              </div>
            </t>
          </div>
        </t>
      </t>
    </t>
  </template>

  <!-- ========================= -->
  <!-- Gabarit : SANS PRIX       -->
  <!-- ========================= -->
  <template id="report_quote_noprices">
    <t t-call="web.html_container">
      <t t-foreach="docs" t-as="o">
        <t t-call="web.external_layout">
          <div class="page">
            <h2 class="mt0">
              <span t-esc="o.company_id.name"/> — <t t-esc="o.name"/> (No prices)
            </h2>

            <div class="row mb16">
              <div class="col-6">
                <strong t-translation="on">Customer</strong><br/>
                <t t-esc="o.partner_id.name"/><br/>
                <t t-esc="o.partner_id.contact_address"/>
              </div>
              <div class="col-6">
                <table class="table table-sm o_main_table" style="width:100%">
                  <tbody>
                    <tr>
                      <td><strong t-translation="on">Date</strong></td>
                      <td class="text-end"><t t-esc="o.date_order and o.date_order.date()"/></td>
                    </tr>
                    <tr>
                      <td><strong t-translation="on">Customer Reference</strong></td>
                      <td class="text-end"><t t-esc="o.x_customer_reference or '-'"/></td>
                    </tr>
                    <tr>
                      <td><strong t-translation="on">Expected Delivery</strong></td>
                      <td class="text-end"><t t-esc="o.x_expected_date or '-'"/></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>

            <t t-if="o.x_project_description">
              <p class="mb16">
                <strong t-translation="on">Project Description:</strong><br/>
                <span t-esc="o.x_project_description"/>
              </p>
            </t>

            <table class="table table-sm o_main_table" style="width:100%">
              <thead>
                <tr>
                  <th t-translation="on">Product</th>
                  <th t-translation="on">Description</th>
                  <th class="text-end" t-translation="on">Qty</th>
                </tr>
              </thead>
              <tbody>
                <t t-foreach="o.order_line" t-as="l">
                  <tr>
                    <td><t t-esc="l.product_id.display_name"/></td>
                    <td><t t-esc="l.name"/></td>
                    <td class="text-end"><t t-esc="l.product_uom_qty"/></td>
                  </tr>
                </t>
              </tbody>
            </table>

            <t t-if="o.x_note">
              <div class="mt16">
                <strong t-translation="on">Notes</strong>
                <div><t t-esc="o.x_note"/></div>
              </div>
            </t>
          </div>
        </t>
      </t>
    </t>
  </template>
</odoo>
